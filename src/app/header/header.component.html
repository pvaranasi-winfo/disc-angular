<div class="flex items-center justify-between px-8 py-6 bg-gradient-to-r from-indigo-50 via-purple-50 to-pink-50 border-b-4 border-indigo-400 shadow-md sticky top-0 z-10">
  <div class="flex items-center gap-4">
    <div class="w-14 h-14 rounded-xl bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center shadow-lg">
      <i class="pi pi-chart-bar text-white text-3xl"></i>
    </div>
    <div>
      <h1 class="text-3xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent mb-2">WinfoTest Discovery Dashboard</h1>
      <p class="text-sm text-gray-600 font-medium">
        Last Scan: {{ data?.scanTimestamp | date:'dd/MM/yyyy, HH:mm:ss' }} | Run ID: {{ data?.runId }}
      </p>
    </div>
  </div>

  <div class="flex items-center gap-3">
    <!-- Environment Badges -->
    <button class="env-button {{ selectedEnvironment === 'Dev' ? 'active' : '' }}" (click)="setEnvironment('Dev')">Dev</button>
    <button class="env-button {{ selectedEnvironment === 'UAT' ? 'active' : '' }}" (click)="setEnvironment('UAT')">UAT</button>
    <button class="env-button {{ selectedEnvironment === 'Prod' ? 'active' : '' }}" (click)="setEnvironment('Prod')">Prod</button>

    <!-- Configure MCP Button -->
    <button class="env-button bg-gradient-to-r from-cyan-500 to-blue-600 text-white hover:from-cyan-600 hover:to-blue-700 shadow-lg hover:shadow-xl transition-all duration-200" (click)="showConfigureMcpPanel = true"><i class="pi pi-wrench"></i></button>

<!-- MCP Config Slide-in Panel -->
<div *ngIf="showConfigureMcpPanel" class="fixed inset-0 z-50 flex items-end justify-end">
  <div class="absolute inset-0 bg-black bg-opacity-20" (click)="closeConfigureMcpPanel()"></div>
  <div class="relative z-10 w-full max-w-md h-full flex flex-col bg-white shadow-2xl slide-in-panel border border-gray-200">
    <div class="flex items-center justify-between px-6 py-4 border-b border-gray-200">
      <h2 class="text-xl font-bold text-gray-900">Configure MCP</h2>
      <button class="text-gray-400 hover:text-gray-900 text-2xl font-bold" (click)="closeConfigureMcpPanel()">&times;</button>
    </div>
    <form class="flex-1 overflow-y-auto px-6 py-4 flex flex-col gap-4" (ngSubmit)="saveMcpConfigs()">
      <ng-container *ngFor="let key of mcpKeys">
        <div>
          <div class="flex items-center justify-between mb-1">
            <label class="block text-gray-700 font-medium capitalize">{{ key }} JSON</label>
            <button type="button" class="env-button bg-blue-700 text-white text-xs px-2 py-1 hover:bg-blue-800" (click)="downloadSampleJson(key)">
              <i class="pi pi-download"></i> 
            </button>
          </div>
          <textarea class="w-full border border-gray-300 rounded px-3 py-2 bg-gray-100 text-gray-900 focus:outline-none focus:ring-2 focus:ring-cyan-500" rows="4" [(ngModel)]="mcpConfigs[key]" name="mcp-{{key}}" (blur)="validateJsonInput(key)"></textarea>
          <div *ngIf="mcpErrors[key]" class="text-red-500 text-xs mt-1">{{ mcpErrors[key] }}</div>
        </div>
      </ng-container>
      <div class="flex justify-end gap-2 mt-4">
        <button type="button" class="env-button bg-gray-200 text-gray-700" (click)="closeConfigureMcpPanel()">Cancel</button>
        <button type="submit" class="env-button bg-cyan-600 text-white font-semibold hover:bg-cyan-700">Save</button>
      </div>
    </form>
  </div>
</div>
    

    <!-- Refresh Button -->
    <button class="env-button" title="Refresh">
      <i class="pi pi-sync"></i>
    </button>
  </div>

  <!-- Toast Modal -->
  <div *ngIf="toastMessage" class="fixed inset-0 z-50 flex items-center justify-center">
    <div class="absolute inset-0 bg-black bg-opacity-20"></div>
    <div class="relative z-10 max-w-xs w-full bg-white rounded-lg shadow-lg p-6 flex flex-col items-center border border-gray-200"
         [ngClass]="toastType === 'success' ? 'border-green-500' : 'border-red-500'">
      <div class="text-3xl mb-2">
        <span *ngIf="toastType === 'success'">✔️</span>
        <span *ngIf="toastType === 'error'">❌</span>
      </div>
      <div class="text-gray-900 text-center mb-4">{{ toastMessage }}</div>
      <button class="env-button bg-gray-200 text-gray-700 w-full" (click)="closeToast()">Close</button>
    </div>
  </div>
</div>