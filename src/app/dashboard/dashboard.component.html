@if (loading()) {
<div class="flex justify-center items-center h-96 dashboard-container">
  <div class="animate-spin rounded-full h-32 w-32 border-b-2 border-blue-500"></div>
</div>
}

@if (error()) {
<div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative" role="alert">
  <strong class="font-bold">Error!</strong>
  <span class="block sm:inline">{{ error() }}</span>
</div>
}

@if (dashboardData() && !loading() && !error()) {
<div class="dashboard-container">
  <!-- Header Section -->
  <app-header [data]="dashboardData()"></app-header>

  <div class="max-w-screen-2xl mx-auto px-8">

    <!-- Stat Cards -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5 mb-8">

      <!-- System Health -->
      <div class="metric-card rounded-2xl shadow-2xl border-2 border-gray-100 px-6 py-6 mb-4 hover:shadow-blue-100 hover:border-blue-200 transition-all">
        <div class="flex items-start justify-between">
          <div class="flex items-center gap-3">
            <i class="pi pi-check-circle icon-success text-2xl"></i>
            <div>
              <div class="text-3xl font-bold text-gray-900 mb-1">{{ dashboardData()?.summaryMetrics?.healthScore }}%</div>
              <div class="text-sm text-gray-500">System Health</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Pending Upgrades -->
      <div class="metric-card rounded-2xl shadow-2xl border-2 border-gray-100 px-6 py-6 mb-4 hover:shadow-blue-100 hover:border-blue-200 transition-all">
        <div class="flex items-start justify-between">
          <div class="flex items-center gap-3">
            <i class="pi pi-exclamation-circle icon-warning text-2xl"></i>
            <div>
              <div class="text-3xl font-bold text-gray-900 mb-1">{{ dashboardData()?.summaryMetrics?.upgradeCount }}</div>
              <div class="text-sm text-gray-500">Pending Upgrades</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Critical Issues -->
      <div class="metric-card rounded-2xl shadow-2xl border-2 border-gray-100 px-6 py-6 mb-4 hover:shadow-blue-100 hover:border-blue-200 transition-all">
        <div class="flex items-start justify-between">
          <div class="flex items-center gap-3">
            <i class="pi pi-exclamation-triangle icon-error text-2xl"></i>
            <div>
              <div class="text-3xl font-bold text-gray-900 mb-1">{{ dashboardData()?.summaryMetrics?.criticalCount }}</div>
              <div class="text-sm text-gray-500">Critical Issues</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Components -->
      <div class="metric-card rounded-2xl shadow-2xl border-2 border-gray-100 px-6 py-6 mb-4 hover:shadow-blue-100 hover:border-blue-200 transition-all">
        <div class="flex items-start justify-between">
          <div class="flex items-center gap-3">
            <i class="pi pi-box icon-info text-2xl"></i>
            <div>
              <div class="text-3xl font-bold text-gray-900 mb-1">{{ dashboardData()?.components?.length }}</div>
              <div class="text-sm text-gray-500">Components</div>
            </div>
          </div>
        </div>
      </div>

    </div>

    <!-- Main Content Grid -->
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

      <!-- Detected Components Section (Left Column - 2/3) -->
      <div class="lg:col-span-2 space-y-6">
        <app-detected-components [components]="dashboardData()?.components || []"></app-detected-components>
      </div>

      <!-- Right Column - Tickets/Issues/Docs (1/3) -->
      <div class="lg:col-span-1 space-y-6">
        <div class="rounded-2xl shadow-2xl border-2 border-gray-100 hover:shadow-blue-100 hover:border-blue-200 transition-all">
          <app-jira-tickets [tickets]="dashboardData()?.insights?.jiraTickets || []"></app-jira-tickets>
        </div>
        <div class="rounded-2xl shadow-2xl border-2 border-gray-100 hover:shadow-blue-100 hover:border-blue-200 transition-all">
          <app-github-issues [issues]="dashboardData()?.insights?.github || []"></app-github-issues>
        </div>
        <div class="rounded-2xl shadow-2xl border-2 border-gray-100 hover:shadow-blue-100 hover:border-blue-200 transition-all">
          <app-documentation [docs]="dashboardData()?.insights?.docs || []"></app-documentation>
        </div>
      </div>

    </div>
  </div>
</div>
}